Solidres=window.Solidres||{},Solidres.InlineEdit=function(e,t){t=t||{};document.querySelectorAll(e).forEach(function(e){const{type:n,name:a,value:s,source:o}=e.dataset,r=document.createElement("div");e.draggable=!1,r.className="sr-inline-edit-container input-group d-none";const i=document.createElement(["number","text"].includes(n)?"input":n);let c=!1;switch(i.name=a,n){case"select":let e=Array.isArray(t.source)?t.source:o;if(console.log(e,"dataSource3"),"string"==typeof e)try{const t=JSON.parse(e);Array.isArray(t)?e=t:(console.warn("source string is not a JSON array:",e),e=[])}catch(t){console.warn("Invalid JSON in source:",t),e=[]}if(Array.isArray(e))for(const t of e){const e=document.createElement("option");"object"==typeof t&&null!==t?(e.value=t.value,e.innerText=t.text):(e.value=t,e.innerText=t),s==e.value&&(e.selected=!0),i.appendChild(e)}i.classList.add("form-select","form-select-sm");break;case"input":case"number":case"text":case"textarea":void 0!==s&&(i.value=s),"number"===n&&(i.type="number",i.min="0"),i.classList.add("form-control","form-control-sm")}r.appendChild(i);const l=document.createElement("button");l.type="button",l.className="btn btn-sm btn-danger",l.innerHTML='<span class="icon-times" aria-hidden="true"></span>',l.addEventListener("click",e=>{e.preventDefault(),r.classList.add("d-none")},!1);const d=document.createElement("button");d.type="button",d.className="btn btn-sm btn-primary",d.innerHTML='<span class="icon-save" aria-hidden="true"></span>',d.addEventListener("click",a=>{if(a.preventDefault(),"string"==typeof t.url){c=!0;const a=function(){const e=document.createElement("span");return Object.assign(e.style,{backgroundImage:"url("+Joomla.getOptions("system.paths").root+"/media/com_solidres/assets/images/ajax-loader2.gif)",backgroundRepeat:"no-repeat",backgroundSize:"contain",width:"25px",height:"14px",display:"inline-block"}),e}();e.parentNode.insertBefore(a,e);const s=()=>{c=!1,a.parentNode.removeChild(a)};window.Joomla?.request({url:t.url,method:"POST",data:new URLSearchParams({...e.dataset,value:i.value}).toString(),onSuccess:a=>{s();let o=i.value;if("select"===n&&Array.isArray(t.source))for(const e of t.source)if(e.value==i.value){o=e.text;break}if("string"==typeof a&&["{","["].includes(a.trim()[0]))try{a=JSON.parse(a)}catch{}a.success&&(e.innerText=o),"function"==typeof t.success&&(document.body.appendChild(r),t.success.bind(e)(a,e),setTimeout(()=>{e.appendChild(r)},0))},onError:()=>{s(),"function"==typeof t.error&&t.error()}})}l.click()},!1),r.appendChild(d),r.appendChild(l),e.style.position="relative",e.style.overflow="visible",Object.assign(r.style,{position:"absolute",left:"0px",top:"100%",width:"230px",zIndex:"100"}),e.appendChild(r),e.addEventListener("click",e=>{e.preventDefault(),c||e.target===r||r.contains(e.target)||r.classList.toggle("d-none")},!1),"function"==typeof t.initContainer&&t.initContainer(r),document.addEventListener("keydown",e=>{"Enter"!==e.key||r.classList.contains("d-none")?"Escape"===e.key&&l.click():d.click()},!1),document.addEventListener("click",e=>{const{target:t}=e;t&&(t===r||t===r.parentElement||r.contains(t))||r.classList.add("d-none")},!1)})};